# ⚡ 充電站損益分析監控面板

一個專為充電站營運管理設計的智能化監控分析系統，提供全方位的站點損益分析與成本結構檢視功能。

## 🌟 主要功能特色

### 📊 多維度分析
- **負責人視角**: 以負責人為單位檢視管理的所有站點
- **時間維度**: 支援單月或跨月份的數據分析
- **站點層級**: 深入到個別站點的詳細營運數據
- **成本結構**: 完整的成本子項目拆解分析

### 💡 智能化監控
- **即時指標**: 總營收、總成本、損益、站點數量
- **效率分析**: 稼動率、周轉率、失敗率追蹤
- **趨勢洞察**: 營收 vs 成本關係圖
- **排行榜**: 各項指標的排行分析

### 🎨 視覺化呈現
- **互動圖表**: 使用 Plotly 製作的動態圖表
- **成本餅圖**: 各站點成本結構的圓餅圖分析
- **損益對比**: 橫向柱狀圖顯示各站損益情況
- **散點分析**: 營收與成本的關係散點圖

## 📁 檔案結構

```
charging-station-dashboard/
├── charging_station_dashboard.py    # 主程式
├── requirements_charging.txt        # Python 套件需求
├── 損益資料_範例.xlsx              # 範例數據檔案
├── README_charging.md              # 說明文檔（本檔案）
└── start_charging.sh               # 啟動腳本
```

## 🚀 快速開始

### 1. 環境準備

```bash
# 安裝 Python 相依套件
pip install -r requirements_charging.txt
```

### 2. 啟動應用程式

```bash
# 方式一：直接執行
streamlit run charging_station_dashboard.py

# 方式二：使用啟動腳本
chmod +x start_charging.sh
./start_charging.sh
```

### 3. 訪問介面

瀏覽器會自動開啟 `http://localhost:8501`，即可開始使用監控面板。

## 📋 數據格式要求

### 必要欄位
系統需要以下核心欄位才能正常運作：

| 欄位名稱 | 資料類型 | 說明 |
|---------|---------|------|
| 月份 | 文字 | 格式: YYYY/MM |
| 負責人 | 文字 | 站點負責人姓名 |
| 站ID | 文字 | 站點唯一識別碼 |
| 名稱 | 文字 | 站點完整名稱 |
| 認列收入 | 數值 | 當月認列收入金額 |
| 認列成本 | 數值 | 當月認列成本總額 |
| 損益 | 數值 | 當月損益（收入-成本）|

### 營運數據欄位
| 欄位名稱 | 資料類型 | 說明 |
|---------|---------|------|
| 經營類型 | 文字 | 如：自營、關站等 |
| 站點規格 | 文字 | 如：純AC站、純DC站 |
| POI | 文字 | 站點類型（車廠、科學園區等）|
| 啟用日期 | 日期 | 站點啟用日期 |
| 充電槍數 | 整數 | 充電槍數量 |
| 全站功率 | 數值 | 總功率(kW) |
| 總充電度數 | 數值 | 總充電量(kWh) |
| 總充電次數 | 整數 | 總充電次數 |
| 成功充電次數 | 整數 | 成功充電次數 |
| 失敗充電次數 | 整數 | 失敗充電次數 |

### 成本結構欄位
系統支援以下成本子項目的詳細分析：

| 成本項目 | 說明 |
|---------|------|
| 共同分攤 | 共同營運成本分攤 |
| 電費分潤成本 | 電力費用及分潤 |
| 設備攤提 | 設備折舊攤提 |
| 租金 | 場地租金費用 |
| 監視系統費 | 監控系統費用 |
| 保險費 | 保險費用 |
| 派工費用 | 維護派工費用 |
| 領料/設備 | 設備材料費用 |
| 其他成本 | 其他雜項成本 |
| 標案成本 | 標案相關成本 |

### 效率指標欄位
| 欄位名稱 | 計算方式 | 說明 |
|---------|---------|------|
| 稼動率 | - | 設備使用效率 |
| 周轉率 | - | 資金周轉效率 |
| 失敗率 | 失敗次數/總次數 | 充電失敗比例 |
| 損益率 | 損益/收入 | 獲利能力指標 |

## 🎯 功能詳解

### Tab 1: 📊 總覽分析
- **損益對比圖**: 橫向柱狀圖顯示各站點損益情況
- **經營類型分析**: 圓餅圖和統計表格
- **關鍵指標卡片**: 總營收、總成本、總損益、站點數量

### Tab 2: 🏢 站點詳情
- **站點選擇器**: 多選站點進行對比分析
- **詳細資訊卡**: 基本資訊、營運數據、財務績效
- **成本結構圖**: 個別站點的成本組成餅圖
- **可展開式檢視**: 方便查看大量站點資訊

### Tab 3: 💹 營收趨勢
- **營收成本散點圖**: 分析營收與成本的關係
- **損益平衡線**: 視覺化顯示盈虧平衡點
- **效率排行榜**: 稼動率和周轉率的前10名排行
- **泡泡大小**: 以充電度數表示站點規模

### Tab 4: 🔧 成本分析
- **整體成本結構**: 所有站點的成本組成分析
- **成本明細表**: 各成本項目的金額和占比
- **效率排行**: 每度電成本最佳和待改善站點
- **成本優化建議**: 基於數據的成本控制建議

## 🔍 篩選功能

### 側邊欄篩選器
- **負責人篩選**: 檢視特定負責人管理的站點
- **月份篩選**: 選擇特定月份的數據
- **經營類型篩選**: 根據經營模式篩選站點

### 動態更新
所有圖表和統計都會根據篩選條件即時更新，提供靈活的分析體驗。

## 💾 數據匯出功能

- **CSV 匯出**: 支援將篩選後的數據匯出為 CSV 格式
- **時間戳記**: 匯出檔案自動加上時間戳記
- **UTF-8 編碼**: 確保中文字元正確顯示

## 🛠️ 技術規格

### 核心技術棧
- **Streamlit**: Web 應用程式框架
- **Pandas**: 數據處理和分析
- **Plotly**: 互動式圖表製作
- **NumPy**: 數值計算

### 系統需求
- Python 3.7 或以上版本
- 記憶體: 建議 2GB 以上
- 瀏覽器: 支援現代瀏覽器（Chrome、Firefox、Safari、Edge）

### 效能特性
- **快取機制**: 使用 Streamlit 快取減少重複計算
- **增量更新**: 只重新計算變更的部分
- **響應式設計**: 適配不同螢幕尺寸

## 🚀 部署選項

### 本地部署
適合內部使用，數據安全性最高：
```bash
streamlit run charging_station_dashboard.py --server.port 8501
```

### 內網部署
適合部門內共享使用：
```bash
streamlit run charging_station_dashboard.py --server.address 0.0.0.0 --server.port 8501
```

### 雲端部署
可部署至 Streamlit Cloud、Heroku、AWS 等平台。

## 🔐 安全性考量

- **數據隱私**: 所有計算都在本地進行，數據不會外傳
- **檔案上傳**: 僅接受 .xlsx 和 .csv 格式，避免安全風險
- **輸入驗證**: 對上傳檔案進行格式和欄位驗證

## 🆘 常見問題

### Q: 為什麼某些圖表顯示空白？
A: 請檢查數據是否包含必要欄位，或該篩選條件下是否有足夠的數據。

### Q: 如何添加更多負責人？
A: 直接在 Excel 檔案中添加更多資料行，系統會自動識別新的負責人。

### Q: 成本結構圖不顯示怎麼辦？
A: 確認該站點的成本子項目有非零數值，系統會自動過濾零值項目。

### Q: 可以處理多少筆數據？
A: 系統可以處理數千筆記錄，但建議單次分析不超過1000個站點以確保效能。

## 🔮 未來功能規劃

- **預測分析**: 基於歷史數據預測未來損益
- **異常檢測**: 自動識別異常的營運數據
- **報告生成**: 自動產生月度/季度報告
- **警報系統**: 當損益低於閾值時發送通知
- **多檔案對比**: 支援不同月份檔案的對比分析

## 🤝 技術支援

如有任何使用問題或功能建議，歡迎聯繫開發團隊。

---

**📝 版本資訊**: v1.0.0  
**📅 最後更新**: 2026年1月29日  
**👨‍💻 開發者**: Claude Assistant  
